<!DOCTYPE html>
<html lang="en">

{{template "header.html"}}

  <body>
    {{template "navbar.html"}}
   
    <div id="map"></div>

    {{template "navbarmobile.html"}}
    {{template "infomodal.html"}}
    {{template "scripts.html"}}
    <script>
        let map;

        //initiate getting user location
        getuserlocation();




        const errorCallback = (error) => {
        console.error(error);
        };

        //checks to see the users browers supports geolocation
        const getCurrentPosition = ({ onSuccess, onError = () => { } }) => {
            if ('geolocation' in navigator === false) {
                return onError(new Error('Geolocation is not supported by your browser, try again on a different browser.'));
            }

            return navigator.geolocation.getCurrentPosition(onSuccess, onError);
            };

        function getuserlocation(){
            if(navigator.geolocation){
                navigator.geolocation.getCurrentPosition(errorCallback);
                setTimeout(getuserlocation, 2000);
            } else {
                alert("Geolocation is not supported by your browser.")
            }
        
        };





        function initMap(){
            var options = {
                center: { lat: 55.909769499991654, lng: -3.3205147727103452 },
                zoom: 16,
                mapTypeId: 'satellite',
            }

            var map = new google.maps.Map(document.getElementById('map'), options);
            
            map.data.loadGeoJson('static/HWUevents.geojson');

            map.data.addListener('click', function (event) {
                var event_title = event.feature.getProperty('eventtittel');
                var image = event.feature.getProperty('image');
                var description = event.feature.getProperty('description');
                var date = event.feature.getProperty('date');

                $('#event_title').html(event_title);
                $('#image').attr("src", image);
                $('#description').html(description);
                $('#date').html(date);
                $('#infomodal').modal('show');
            });
        } 

    

    </script>

    <script async 
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCfMTAfaDTcu0sW9YzHIHdvV8NGA4YFoGI&callback=initMap"
        type="text/javascript"></script>
  </body>

{{template "footer.html"}}